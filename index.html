<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Command Center ‚Äî Schneider Electric</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0a0a;--bg2:#111;--bg3:#1a1a1a;--bg4:#222;--bd:#2a2a2a;--bd2:#333;--t1:#f0f0f0;--t2:#aaa;--t3:#666;--grn:#3DCC4A;--grn2:#2ea838;--grn3:rgba(61,204,74,.12);--blu:#4A9EFF;--blu2:rgba(74,158,255,.12);--gld:#FFB84D;--gld2:rgba(255,184,77,.12);--pur:#A855F7;--pur2:rgba(168,85,247,.12);--red:#FF4D4D;--red2:rgba(255,77,77,.12);--cyan:#22D3EE;--cyan2:rgba(34,211,238,.12);--radius:8px;--radius2:12px}
html,body{height:100%;font-family:'SF Pro Display',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--t1);font-size:13px;line-height:1.5}
a{color:var(--grn);text-decoration:none}input,textarea,select,button{font-family:inherit;font-size:inherit}
::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--bd);border-radius:3px}::-webkit-scrollbar-thumb:hover{background:var(--bd2)}
.login-wrap{display:flex;align-items:center;justify-content:center;min-height:100vh;background:var(--bg)}
.login-box{width:420px;padding:48px 40px;background:var(--bg2);border:1px solid var(--bd);border-radius:var(--radius2)}
.login-logo{display:flex;align-items:center;gap:12px;margin-bottom:32px}
.login-logo svg{flex-shrink:0}.login-logo .lt{font-size:18px;font-weight:700;color:var(--t1)}.login-logo .ls{font-size:11px;color:var(--t3);margin-top:2px}
.login-box label{display:block;font-size:11px;color:var(--t2);margin-bottom:4px;text-transform:uppercase;letter-spacing:.5px}
.login-box input{width:100%;padding:10px 12px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);color:var(--t1);margin-bottom:16px;outline:none;transition:border .2s}
.login-box input:focus{border-color:var(--grn)}
.btn-login{width:100%;padding:12px;background:var(--grn);color:#000;border:none;border-radius:var(--radius);font-weight:700;font-size:14px;cursor:pointer;transition:background .2s}
.btn-login:hover{background:var(--grn2)}
.btn-demo{width:100%;padding:10px;background:transparent;color:var(--t2);border:1px solid var(--bd);border-radius:var(--radius);cursor:pointer;margin-top:8px;transition:all .2s}
.btn-demo:hover{color:var(--t1);border-color:var(--bd2)}
.shell{display:flex;height:100vh;overflow:hidden}
.sidebar{width:220px;background:var(--bg2);border-right:1px solid var(--bd);display:flex;flex-direction:column;flex-shrink:0;overflow-y:auto}
.sb-logo{display:flex;align-items:center;gap:10px;padding:16px 16px 12px}.sb-logo .lt{font-size:14px;font-weight:700}.sb-logo .ls{font-size:10px;color:var(--t3)}
.nav-sec{padding:4px 8px}.nav-sec-title{font-size:9px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:1px;padding:12px 8px 4px}
.nav-btn{display:flex;align-items:center;gap:8px;width:100%;padding:8px 12px;background:none;border:none;border-radius:6px;color:var(--t2);cursor:pointer;text-align:left;font-size:12px;transition:all .15s}
.nav-btn:hover{background:var(--bg3);color:var(--t1)}.nav-btn.on{background:var(--grn3);color:var(--grn);font-weight:600}.nav-btn .ni{width:16px;text-align:center;font-size:14px}
.sb-footer{margin-top:auto;padding:12px;border-top:1px solid var(--bd);font-size:9px;color:var(--t3)}
.sync-btn{width:100%;padding:6px 8px;background:var(--bg3);border:1px solid var(--bd);border-radius:6px;color:var(--t2);cursor:pointer;font-size:10px;margin-top:6px;transition:all .2s}
.sync-btn:hover{border-color:var(--grn);color:var(--grn)}
.sb-oe{display:flex;align-items:center;gap:6px;margin:4px 8px;padding:8px 12px;background:var(--grn3);border:1px solid rgba(61,204,74,.2);border-radius:6px;color:var(--grn);font-size:11px;font-weight:600;cursor:pointer;text-decoration:none;transition:all .2s}
.sb-oe:hover{background:rgba(61,204,74,.18);border-color:rgba(61,204,74,.35)}
.main{flex:1;overflow-y:auto;padding:24px 28px}
.main h1{font-size:22px;font-weight:700;margin-bottom:4px}.main .sub{font-size:12px;color:var(--t3);margin-bottom:24px}
.gs-bar{position:fixed;top:0;left:220px;right:0;height:48px;background:rgba(10,10,10,.95);backdrop-filter:blur(12px);border-bottom:1px solid var(--bd);display:flex;align-items:center;padding:0 28px;z-index:100;gap:12px}
.gs-bar input{flex:1;background:var(--bg3);border:1px solid var(--bd);border-radius:6px;padding:8px 12px 8px 32px;color:var(--t1);outline:none;font-size:12px}.gs-bar input:focus{border-color:var(--grn)}
.gs-bar .gsi{position:absolute;left:40px;color:var(--t3);font-size:13px;pointer-events:none}
.gs-bar .gsh{font-size:10px;color:var(--t3);background:var(--bg3);padding:2px 6px;border-radius:3px;border:1px solid var(--bd)}
.gs-res{position:fixed;top:48px;left:220px;right:0;max-height:60vh;overflow-y:auto;background:var(--bg2);border-bottom:1px solid var(--bd);z-index:99;display:none}
.gs-res.active{display:block}.gs-cat{padding:8px 28px 4px;font-size:9px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px}
.gs-item{display:flex;align-items:center;gap:12px;padding:8px 28px;cursor:pointer;transition:background .1s}.gs-item:hover,.gs-item.sel{background:var(--bg3)}
.gs-item .gn{color:var(--t1);font-weight:500}.gs-item .gm{color:var(--t3);font-size:11px}
.kpi-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:16px;margin-bottom:24px}
.kpi{background:var(--bg2);border:1px solid var(--bd);border-radius:var(--radius2);padding:20px}
.kpi .kl{font-size:11px;color:var(--t3);text-transform:uppercase;letter-spacing:.5px}.kpi .kv{font-size:32px;font-weight:800;margin-top:4px;font-variant-numeric:tabular-nums}.kpi .ks{font-size:11px;color:var(--t3);margin-top:4px}
.card{background:var(--bg2);border:1px solid var(--bd);border-radius:var(--radius2);padding:20px;margin-bottom:16px}.card h3{font-size:14px;font-weight:700;margin-bottom:12px}
.badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600}
table{width:100%;border-collapse:collapse}th{text-align:left;padding:8px 12px;font-size:10px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;border-bottom:1px solid var(--bd);position:sticky;top:0;background:var(--bg2)}
td{padding:8px 12px;border-bottom:1px solid var(--bd);font-size:12px;color:var(--t2)}tr:hover td{background:var(--bg3);color:var(--t1)}tr.clk{cursor:pointer}
.kanban{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;min-height:400px}
.kcol{background:var(--bg2);border:1px solid var(--bd);border-radius:var(--radius2);padding:12px;min-height:300px}
.kcol-t{font-size:11px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:12px;display:flex;align-items:center;justify-content:space-between}
.kcol-t .cnt{background:var(--bg3);padding:1px 6px;border-radius:10px;font-size:10px}
.kcard{background:var(--bg3);border:1px solid var(--bd);border-radius:var(--radius);padding:10px;margin-bottom:8px;cursor:pointer;transition:all .15s}
.kcard:hover{border-color:var(--grn);transform:translateY(-1px)}
.dp{position:fixed;right:0;top:48px;bottom:0;width:420px;background:var(--bg2);border-left:1px solid var(--bd);z-index:50;transform:translateX(100%);transition:transform .25s ease;overflow-y:auto;padding:24px}
.dp.open{transform:translateX(0)}.dp-x{position:absolute;top:12px;right:12px;background:none;border:none;color:var(--t3);cursor:pointer;font-size:18px}.dp-x:hover{color:var(--t1)}
.dp-f{margin-bottom:14px}.dp-f label{display:block;font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}.dp-f .dv{font-size:13px;color:var(--t1)}
.org-layer{margin-bottom:24px}.org-lt{font-size:11px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px;padding-bottom:4px;border-bottom:1px solid var(--bd)}
.org-cards{display:flex;flex-wrap:wrap;gap:10px}
.oc{background:var(--bg3);border:1px solid var(--bd);border-radius:var(--radius);padding:10px 14px;cursor:pointer;transition:all .15s;min-width:160px}.oc:hover{border-color:var(--grn);transform:translateY(-1px)}
.play-card{background:var(--bg2);border:1px solid var(--bd);border-radius:var(--radius2);margin-bottom:12px;overflow:hidden}
.play-h{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;cursor:pointer;transition:background .15s}.play-h:hover{background:var(--bg3)}
.play-b{padding:0 20px 16px;display:none}.play-card.exp .play-b{display:block}.play-card.exp .pa{transform:rotate(180deg)}.pa{color:var(--t3);transition:transform .2s;font-size:12px}
.cov-bar{height:6px;background:var(--bg);border-radius:3px;overflow:hidden;margin-top:6px}.cov-bar .fill{height:100%;border-radius:3px;transition:width .3s}
.ai-p{background:var(--bg2);border:1px solid var(--bd);border-radius:var(--radius2);padding:20px}
.ai-p textarea{width:100%;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);padding:12px;color:var(--t1);resize:vertical;min-height:80px;outline:none}.ai-p textarea:focus{border-color:var(--grn)}
.ai-btn{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;background:var(--grn);color:#000;border:none;border-radius:var(--radius);font-weight:700;font-size:12px;cursor:pointer;margin-top:8px;transition:background .2s}.ai-btn:hover{background:var(--grn2)}.ai-btn:disabled{opacity:.5;cursor:not-allowed}
.ai-out{margin-top:16px;padding:16px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);white-space:pre-wrap;font-size:12px;color:var(--t2);line-height:1.6;max-height:500px;overflow-y:auto}
.filters{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap}
.filters select,.filters input{padding:6px 10px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);color:var(--t1);font-size:11px;outline:none}.filters select:focus,.filters input:focus{border-color:var(--grn)}
.rel-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px}
.rel-c{background:var(--bg3);border:1px solid var(--bd);border-radius:var(--radius);padding:14px}
.risk-item{display:flex;align-items:center;gap:12px;padding:12px 16px;background:var(--bg3);border:1px solid var(--bd);border-radius:var(--radius);margin-bottom:8px}
.rdot{width:8px;height:8px;border-radius:50%;flex-shrink:0}.rdot.hi{background:var(--red)}.rdot.md{background:var(--gld)}.rdot.lo{background:var(--grn)}
.comp-c{background:var(--bg2);border:1px solid var(--bd);border-radius:var(--radius2);padding:20px;margin-bottom:12px}
.wt-c{background:var(--bg2);border:1px solid var(--bd);border-radius:var(--radius2);padding:20px;margin-bottom:12px}
.wt-b{padding:8px 12px;background:var(--bg3);border-radius:var(--radius);margin-top:8px;font-size:12px}
.wt-b strong{color:var(--grn);font-size:10px;text-transform:uppercase;letter-spacing:.5px;display:block;margin-bottom:4px}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid var(--bd);border-top-color:var(--grn);border-radius:50%;animation:spin .6s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
@media(max-width:900px){.sidebar{width:60px;overflow:hidden}.nav-btn span:last-child,.nav-sec-title,.sb-footer>:not(.sync-btn),.sb-oe span{display:none}.sb-logo .lt,.sb-logo .ls{display:none}.gs-bar{left:60px}.dp{width:100%}.kanban{grid-template-columns:1fr}}
</style>
</head>
<body>
<div id="app"></div>
<script>
// ===== STATE =====
var S={screen:'app',tab:'dashboard',contacts:[],conn:false,syncing:false,lastSync:null,search:'',searchResults:[],searchOpen:false,searchIdx:0,detailId:null,filterTier:'',filterStatus:'',filterInit:'',filterText:'',aiLoading:false,aiOutput:'',expandedPlays:{},
sheetId:localStorage.getItem('cc_sheetId')||'1LP0iNBVIXhoXp1mGugD5sz5hVplonnFFm52OiAE_-eY',
gApiKey:localStorage.getItem('cc_gApiKey')||'AIzaSyDpgRXwsgR5W8kDTgvE9vVEkyjXwu9JFDo',
claudeKey:localStorage.getItem('cc_claudeKey')||'',
webAppUrl:localStorage.getItem('cc_webAppUrl')||''};

var DEMO=[
{id:1,name:"Charise Le",title:"SVP, Chief Human Resources Officer",location:"Dallas, TX",tier:"Tier 0",initiative:"SE Advisory",timing:"Immediate",status:"Engaged",outreachDate:"2025-01-15",channel:"LinkedIn",response:"Yes",meeting:"Yes",meetingDate:"2025-02-01",nextStep:"Follow-up on workforce transformation proposal",owner:"Matt",notes:"Key champion. Endorsed Toptal to ExCom.",seqDays:"1",seqPhase:"Touch 3",whyBuyNow:"Building SE Advisory from scratch ‚Äî needs 200+ consultants by 2026",hook:"Your workforce transformation at scale aligns with what we've done for Siemens & ABB",linkedin:"https://linkedin.com/in/charisele",buyingRole:"Champion",fit:"10",budgetSignal:"$500M+ consulting buildout announced"},
{id:2,name:"Philippe Rambach",title:"SVP, AI & Chief AI Officer",location:"Paris, France",tier:"Tier 1",initiative:"AI/ML",timing:"Immediate",status:"Outreach Sent",outreachDate:"2025-01-20",channel:"Email",response:"No",meeting:"No",meetingDate:"",nextStep:"Send follow-up with AI talent case study",owner:"Matt",notes:"Owns SchneiderAI & EcoStruxure Foresight.",seqDays:"3",seqPhase:"Touch 1",whyBuyNow:"Launching EcoStruxure Foresight ‚Äî first predictive energy platform",hook:"We staffed 40 ML engineers for a Fortune 100 energy company in 6 weeks",linkedin:"https://linkedin.com/in/philipperambach",buyingRole:"Economic Buyer",fit:"9",budgetSignal:"‚Ç¨300M R&D budget for AI"},
{id:3,name:"Gregory McManaway",title:"SVP, US Operations & SE Advisory Services Lead",location:"Nashville, TN",tier:"Tier 1",initiative:"SE Advisory",timing:"Immediate",status:"Researching",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"Research LinkedIn, find warm intro via Charise",owner:"Matt",notes:"Runs SE Advisory Services.",seqDays:"5",seqPhase:"Pre-outreach",whyBuyNow:"Scaling advisory practice to compete with Accenture/Deloitte",hook:"We've helped 3 consulting firms scale their bench by 50% in 90 days",linkedin:"https://linkedin.com/in/gregorymcmanaway",buyingRole:"Decision Maker",fit:"9",budgetSignal:"Advisory arm targeting $1B revenue by 2028"},
{id:4,name:"Steve Wilhite",title:"VP, SE Advisory Services",location:"Dallas, TX",tier:"Tier 1",initiative:"SE Advisory",timing:"Immediate",status:"Not Started",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"LinkedIn connection request with advisory hook",owner:"Matt",notes:"Building the consulting bench.",seqDays:"2",seqPhase:"Touch 1",whyBuyNow:"Hiring consultants ‚Äî needs experienced strategy & change management talent",hook:"We source ex-McKinsey/BCG consultants for enterprise advisory practices",linkedin:"https://linkedin.com/in/stevewilhite",buyingRole:"Technical Buyer",fit:"10",budgetSignal:"Open headcount for 50+ advisory roles"},
{id:5,name:"Bobby Cain",title:"SVP, Cooling & AI Infrastructure",location:"Andover, MA",tier:"Tier 1",initiative:"Motivair/Cooling",timing:"Q1 2025",status:"Researching",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"Research Motivair integration needs",owner:"Matt",notes:"Runs liquid cooling division.",seqDays:"7",seqPhase:"Pre-outreach",whyBuyNow:"Integrating Motivair acquisition ‚Äî 4 facilities scaling rapidly",hook:"We've staffed cooling engineering teams for hyperscaler data centers",linkedin:"https://linkedin.com/in/bobbycain",buyingRole:"Economic Buyer",fit:"8",budgetSignal:"$2.3B in cooling deals in pipeline"},
{id:6,name:"Fr√©d√©ric Godemel",title:"EVP, Power Products & EcoStruxure",location:"Paris, France",tier:"Tier 1",initiative:"Digital/EcoStruxure",timing:"Q1 2025",status:"Not Started",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"Develop EcoStruxure talent angle",owner:"Matt",notes:"Oversees EcoStruxure platform strategy.",seqDays:"10",seqPhase:"Pre-outreach",whyBuyNow:"EcoStruxure platform expansion across all verticals",hook:"We've placed 200+ IoT platform engineers in the last 12 months",linkedin:"https://linkedin.com/in/fredericgodemel",buyingRole:"Economic Buyer",fit:"8",budgetSignal:"EcoStruxure is core revenue driver"},
{id:7,name:"Peter Weckesser",title:"Chief Digital Officer",location:"Paris, France",tier:"Tier 1",initiative:"Digital/EcoStruxure",timing:"Q1 2025",status:"Not Started",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"Research One Digital Grid initiative",owner:"Matt",notes:"Owns digital transformation across SE.",seqDays:"10",seqPhase:"Pre-outreach",whyBuyNow:"One Digital Grid Platform launch ‚Äî massive software buildout",hook:"We help CDOs build engineering teams 3x faster than traditional recruiting",linkedin:"https://linkedin.com/in/peterweckesser",buyingRole:"Decision Maker",fit:"8",budgetSignal:"$700M+ US manufacturing + digital investment"},
{id:8,name:"Aamir Paul",title:"President, North America Operations",location:"Boston, MA",tier:"Tier 1",initiative:"SE Advisory",timing:"Q1 2025",status:"Not Started",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"Develop executive outreach strategy",owner:"Matt",notes:"Oversees all NA operations.",seqDays:"14",seqPhase:"Pre-outreach",whyBuyNow:"NA expansion ‚Äî $700M manufacturing investment + SE Advisory buildout",hook:"We've supported 4 industrial companies through NA expansion surges",linkedin:"https://linkedin.com/in/aamirpaul",buyingRole:"Executive Sponsor",fit:"7",budgetSignal:"$700M US investment announced"},
{id:9,name:"Jennifer Curtis",title:"VP Talent Acquisition",location:"Dallas, TX",tier:"Tier 0",initiative:"SE Advisory",timing:"Immediate",status:"Outreach Sent",outreachDate:"2025-01-18",channel:"LinkedIn",response:"Pending",meeting:"No",meetingDate:"",nextStep:"Follow-up if no response by 1/25",owner:"Matt",notes:"Owns TA. Potential operational champion.",seqDays:"1",seqPhase:"Touch 2",whyBuyNow:"Massive hiring surge ‚Äî 200+ advisory roles, 100+ engineering",hook:"We fill niche roles 60% faster than traditional agencies",linkedin:"https://linkedin.com/in/jennifercurtis",buyingRole:"Champion",fit:"10",budgetSignal:"4,000+ open roles on careers page"},
{id:10,name:"Annette Clayton",title:"CEO, North America",location:"Dallas, TX",tier:"Tier 2",initiative:"SE Advisory",timing:"Q2 2025",status:"Not Started",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"Build warm path through Charise or Aamir",owner:"Matt",notes:"Ultimate decision maker for NA.",seqDays:"21",seqPhase:"Pre-outreach",whyBuyNow:"Driving Schneider's NA growth strategy",hook:"Executive briefing on talent market trends in industrial technology",linkedin:"https://linkedin.com/in/annetteclayton",buyingRole:"Executive Sponsor",fit:"6",budgetSignal:"Board-level growth mandate"},
{id:11,name:"Gwenaelle Avice-Huet",title:"EVP, Strategy & Sustainability",location:"Paris, France",tier:"Tier 2",initiative:"SE Advisory",timing:"Q2 2025",status:"Not Started",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"Monitor sustainability consulting opportunities",owner:"Matt",notes:"Sustainability strategy.",seqDays:"30",seqPhase:"Pre-outreach",whyBuyNow:"Sustainability consulting demand surge in industrial sector",hook:"We've placed 50+ ESG/sustainability consultants for Fortune 500s",linkedin:"https://linkedin.com/in/gwenaelleavicehuet",buyingRole:"Influencer",fit:"6",budgetSignal:"ESG reporting mandates driving demand"},
{id:12,name:"Rich Whitmore",title:"CEO, Motivair (SE subsidiary)",location:"Buffalo, NY",tier:"Tier 2",initiative:"Motivair/Cooling",timing:"Q1 2025",status:"Researching",outreachDate:"",channel:"",response:"",meeting:"No",meetingDate:"",nextStep:"Map Motivair engineering org structure",owner:"Matt",notes:"Runs Motivair post-acquisition.",seqDays:"14",seqPhase:"Pre-outreach",whyBuyNow:"Post-acquisition scaling ‚Äî need engineers for 4 manufacturing facilities",hook:"We specialize in engineering talent for high-growth hardware companies post-M&A",linkedin:"https://linkedin.com/in/richwhitmore",buyingRole:"Decision Maker",fit:"8",budgetSignal:"4 facilities scaling simultaneously"}
];

var PLAYS=[
{id:"advisory",name:"SE Advisory Services",color:"var(--gld)",bg:"var(--gld2)",desc:"Build the consulting bench to compete with Accenture/Deloitte",sponsors:["Charise Le","Gregory McManaway"],vps:["Steve Wilhite"],exec:["Jennifer Curtis"]},
{id:"ai",name:"AI & Machine Learning",color:"var(--blu)",bg:"var(--blu2)",desc:"Staff EcoStruxure Foresight & SchneiderAI initiatives",sponsors:["Philippe Rambach"],vps:[],exec:[]},
{id:"cooling",name:"Motivair / Cooling Infrastructure",color:"var(--cyan)",bg:"var(--cyan2)",desc:"Engineering talent for liquid cooling scale-up",sponsors:["Bobby Cain"],vps:["Rich Whitmore"],exec:[]},
{id:"digital",name:"Digital Transformation / EcoStruxure",color:"var(--pur)",bg:"var(--pur2)",desc:"One Digital Grid Platform & EcoStruxure expansion",sponsors:["Fr√©d√©ric Godemel","Peter Weckesser"],vps:[],exec:[]},
{id:"executive",name:"Executive Engagement",color:"var(--red)",bg:"var(--red2)",desc:"C-suite relationships for enterprise-wide positioning",sponsors:["Aamir Paul","Annette Clayton"],vps:["Gwenaelle Avice-Huet"],exec:[]}
];

var COMPETITORS=[
{name:"Accenture",where:"Embedded in SE Advisory strategy consulting. Multi-year MSA.",displace:"Position Toptal as the agile, specialized alternative ‚Äî faster time-to-fill, domain experts not generalists, no bench-warming overhead."},
{name:"Deloitte",where:"Digital transformation advisory, SAP implementation support.",displace:"Highlight Toptal's tech-first DNA. Our talent actually builds, not just advises. Cost comparison: Toptal at 40-60% of Big 4 rates."},
{name:"Infosys / TCS",where:"Large-scale IT services, ERP support, application maintenance.",displace:"Quality over quantity. Toptal's top 3% vetting vs. body shops. Case studies showing rework reduction and faster delivery."},
{name:"Hays / Robert Half",where:"Traditional staffing for mid-level engineering and finance roles.",displace:"Toptal's global network accesses talent these firms can't reach. Specialization in hard-to-fill roles."},
{name:"Internal Recruiting",where:"4,000+ open roles on careers page ‚Äî TA team overwhelmed.",displace:"Frame as force multiplier, not replacement. We handle the hardest 10% of roles that take 90% of TA's time."}
];

var WIN_THEMES=[
{play:"SE Advisory",theme:"Workforce Transformation at Scale",technical:"We source consultants with real domain expertise ‚Äî not generalists who need months of onboarding.",economic:"50% faster time-to-revenue vs. traditional recruiting. No bench costs. Pay only for active consultants."},
{play:"AI/ML",theme:"The Talent Moat for AI Leadership",technical:"Access to top 3% ML engineers, data scientists, and AI architects globally.",economic:"Avoid the $300K+ fully loaded cost of full-time senior ML engineers. Flex capacity up/down."},
{play:"Motivair/Cooling",theme:"Engineering Velocity for Hardware Scale-Up",technical:"Mechanical, thermal, and manufacturing engineers who've worked in high-growth hardware environments.",economic:"Fill critical engineering roles 60% faster than internal TA. Reduce production delays."},
{play:"Digital/EcoStruxure",theme:"Platform Engineering on Demand",technical:"Full-stack, IoT, cloud, and data platform engineers experienced with industrial IoT environments.",economic:"Build your One Digital Grid team without 12-month hiring cycles. Deploy in 2-3 weeks."},
{play:"Executive Engagement",theme:"Strategic Workforce Partner, Not a Vendor",technical:"We understand Schneider's business ‚Äî energy management, industrial automation, sustainability.",economic:"Enterprise MSA structure with volume incentives. Single partner reduces vendor management overhead by 70%."}
];

var RELS=[
{from:"Charise Le",type:"Champions ‚Üí",to:"Steve Wilhite, Jennifer Curtis, Gregory McManaway"},
{from:"Gregory McManaway",type:"Reports to ‚Üí",to:"Aamir Paul"},
{from:"Steve Wilhite",type:"Reports to ‚Üí",to:"Gregory McManaway"},
{from:"Philippe Rambach",type:"ExCom peer of ‚Üí",to:"Fr√©d√©ric Godemel, Peter Weckesser"},
{from:"Bobby Cain",type:"Oversees ‚Üí",to:"Rich Whitmore (Motivair)"},
{from:"Aamir Paul",type:"Reports to ‚Üí",to:"Annette Clayton"},
{from:"Jennifer Curtis",type:"Warm path to ‚Üí",to:"Charise Le (both HR)"},
{from:"Fr√©d√©ric Godemel",type:"ExCom peer of ‚Üí",to:"Peter Weckesser, Philippe Rambach"},
{from:"Gwenaelle Avice-Huet",type:"Adjacent to ‚Üí",to:"SE Advisory (sustainability consulting)"}
];

var NAV=[
{s:"COMMAND",items:[{id:"dashboard",icon:"‚óâ",l:"Dashboard"},{id:"thisweek",icon:"‚ó∑",l:"This Week"},{id:"pipeline",icon:"‚ñ¶",l:"Pipeline"},{id:"contacts",icon:"‚óé",l:"Contacts"}]},
{s:"STRATEGY",items:[{id:"orgchart",icon:"‚äû",l:"Org Chart"},{id:"stratmap",icon:"‚óÜ",l:"Strategy Map"},{id:"winthemes",icon:"‚öë",l:"Win Themes"},{id:"competitive",icon:"‚öî",l:"Competitive"}]},
{s:"AI TOOLS",items:[{id:"meetprep",icon:"‚úé",l:"Meeting Prep"},{id:"sequencer",icon:"‚Üª",l:"Sequencer"},{id:"execbrief",icon:"‚ä°",l:"Exec Brief"},{id:"aiintel",icon:"‚ö°",l:"AI Intel"}]},
{s:"MONITOR",items:[{id:"relations",icon:"‚ü∑",l:"Relationships"},{id:"risks",icon:"‚ñ≤",l:"Risks"},{id:"settings",icon:"‚öô",l:"Settings"}]}
];

// ===== HELPERS =====
function gc(){return S.contacts.length?S.contacts:DEMO}
function tc(t){return t==='Tier 0'?'var(--grn)':t==='Tier 1'?'var(--blu)':t==='Tier 2'?'var(--gld)':t==='Tier 3'?'var(--pur)':'var(--t3)'}
function sc(s){var m={'Not Started':'var(--t3)','Researching':'var(--pur)','Outreach Sent':'var(--blu)','Responded':'var(--cyan)','Meeting Set':'var(--grn)','Engaged':'var(--grn)','Closed Won':'var(--grn)','Stalled':'var(--red)','Nurture':'var(--gld)'};return m[s]||'var(--t3)'}
function ic(i){if(i&&i.indexOf('Advisory')>=0)return'var(--gld)';if(i&&i.indexOf('AI')>=0)return'var(--blu)';if(i&&(i.indexOf('Motivair')>=0||i.indexOf('Cool')>=0))return'var(--cyan)';if(i&&(i.indexOf('Digital')>=0||i.indexOf('Eco')>=0))return'var(--pur)';return'var(--t3)'}
function eh(s){var d=document.createElement('div');d.textContent=s;return d.innerHTML}
function ds(d){if(!d)return 999;return Math.floor((Date.now()-new Date(d).getTime())/86400000)}
function bdg(text,color){return'<span class="badge" style="background:'+color+'22;color:'+color+'">'+eh(text)+'</span>'}

function fetchSheet(cb){
if(!S.gApiKey||!S.sheetId){cb([]);return}
S.syncing=true;render();
fetch('https://sheets.googleapis.com/v4/spreadsheets/'+S.sheetId+'/values/Outreach%20Tracker!A6:X200?key='+S.gApiKey).then(function(r){return r.json()}).then(function(data){
if(!data.values){S.syncing=false;cb([]);return}
var rows=data.values.map(function(r,i){return{id:i+1,name:r[1]||'',title:r[2]||'',location:r[3]||'',tier:r[4]||'',initiative:r[5]||'',timing:r[6]||'',status:r[7]||'',outreachDate:r[8]||'',channel:r[9]||'',response:r[10]||'',meeting:r[11]||'',meetingDate:r[12]||'',nextStep:r[13]||'',owner:r[14]||'',notes:r[15]||'',seqDays:r[16]||'',seqPhase:r[17]||'',whyBuyNow:r[18]||'',hook:r[19]||'',linkedin:r[20]||'',buyingRole:r[21]||'',fit:r[22]||'',budgetSignal:r[23]||''}}).filter(function(r){return r.name});
S.syncing=false;S.conn=true;S.lastSync=new Date();cb(rows);
}).catch(function(e){console.error('Sheet fetch:',e);S.syncing=false;cb([])});
}

function aiCall(prompt,cb){
if(!S.claudeKey){cb('‚ö† No Anthropic API key. Add it in Settings.');return}
S.aiLoading=true;render();
fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','x-api-key':S.claudeKey,'anthropic-version':'2023-06-01','anthropic-dangerous-direct-browser-access':'true'},
body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:2000,messages:[{role:'user',content:prompt}]})
}).then(function(r){return r.json()}).then(function(data){
S.aiLoading=false;cb((data.content&&data.content[0])?data.content[0].text:'Error: '+JSON.stringify(data));
}).catch(function(e){S.aiLoading=false;cb('Error: '+e.message)});
}

function doSearch(q){
if(!q){S.searchResults=[];return}var ql=q.toLowerCase();var r=[];
gc().forEach(function(c){if((c.name+' '+c.title+' '+c.initiative+' '+c.tier).toLowerCase().indexOf(ql)>=0)r.push({type:'contact',name:c.name,meta:c.title+' ¬∑ '+c.tier,action:function(){S.tab='contacts';S.detailId=c.id;S.searchOpen=false;S.search='';render()}})});
PLAYS.forEach(function(p){if(p.name.toLowerCase().indexOf(ql)>=0)r.push({type:'play',name:p.name,meta:p.desc,action:function(){S.tab='stratmap';S.expandedPlays[p.id]=true;S.searchOpen=false;S.search='';render()}})});
NAV.forEach(function(sec){sec.items.forEach(function(it){if(it.l.toLowerCase().indexOf(ql)>=0)r.push({type:'page',name:it.l,meta:'Page',action:function(){S.tab=it.id;S.searchOpen=false;S.search='';render()}})})});
COMPETITORS.forEach(function(c){if(c.name.toLowerCase().indexOf(ql)>=0)r.push({type:'competitor',name:c.name,meta:'Competitive Intel',action:function(){S.tab='competitive';S.searchOpen=false;S.search='';render()}})});
S.searchResults=r;S.searchIdx=0;
}
// ===== PAGE RENDERERS =====
function pgDash(){
var cc=gc(),total=cc.length,inPlay=cc.filter(function(c){return['Outreach Sent','Responded','Meeting Set','Engaged'].indexOf(c.status)>=0}).length,
responded=cc.filter(function(c){return c.response==='Yes'||c.status==='Responded'}).length,
meetings=cc.filter(function(c){return c.meeting==='Yes'}).length,
engaged=cc.filter(function(c){return c.status==='Engaged'||c.status==='Closed Won'}).length,
stalled=cc.filter(function(c){return c.outreachDate&&ds(c.outreachDate)>14&&c.response!=='Yes'&&c.status!=='Engaged'}).length;
var h='<h1>Dashboard</h1><div class="sub">'+total+' contacts across '+new Set(cc.map(function(c){return c.initiative})).size+' initiatives</div>';
h+='<div class="kpi-row">';
h+='<div class="kpi"><div class="kl">Pipeline</div><div class="kv" style="color:var(--t1)">'+total+'</div><div class="ks">Total contacts</div></div>';
h+='<div class="kpi"><div class="kl">In Play</div><div class="kv" style="color:var(--blu)">'+inPlay+'</div><div class="ks">Active outreach</div></div>';
h+='<div class="kpi"><div class="kl">Responded</div><div class="kv" style="color:var(--cyan)">'+responded+'</div><div class="ks">'+(total?Math.round(responded/total*100):0)+'% response rate</div></div>';
h+='<div class="kpi"><div class="kl">Meetings</div><div class="kv" style="color:var(--grn)">'+meetings+'</div><div class="ks">Meetings set</div></div>';
h+='<div class="kpi"><div class="kl">Engaged</div><div class="kv" style="color:var(--grn)">'+engaged+'</div><div class="ks">Active relationships</div></div>';
h+='<div class="kpi"><div class="kl">‚ö† Stalled</div><div class="kv" style="color:var(--red)">'+stalled+'</div><div class="ks">14+ days no response</div></div>';
h+='</div>';
// Priority Queue
h+='<div class="card"><h3>üéØ Priority Queue ‚Äî Contact Today</h3>';
var pri=cc.filter(function(c){return c.tier==='Tier 0'||c.tier==='Tier 1'}).sort(function(a,b){return(parseInt(a.seqDays)||999)-(parseInt(b.seqDays)||999)}).slice(0,5);
pri.forEach(function(c){h+='<div style="display:flex;align-items:center;gap:12px;padding:8px 0;border-bottom:1px solid var(--bd)">'+bdg(c.tier,tc(c.tier))+'<div style="flex:1"><div style="font-weight:600;cursor:pointer" data-detail="'+c.id+'">'+eh(c.name)+'</div><div style="font-size:11px;color:var(--t3)">'+eh(c.title)+'</div></div>'+bdg(c.status,sc(c.status))+'<div style="font-size:11px;color:var(--t2);text-align:right;min-width:120px">'+eh((c.nextStep||'').substring(0,50))+'</div></div>'});
if(!pri.length)h+='<div style="color:var(--t3);padding:12px">No priority contacts</div>';
h+='</div>';
// Funnel
h+='<div class="card"><h3>Funnel</h3>';
['Not Started','Researching','Outreach Sent','Responded','Meeting Set','Engaged','Closed Won'].forEach(function(st){
var cnt=cc.filter(function(c){return c.status===st}).length,pct=total?Math.round(cnt/total*100):0;
h+='<div style="display:flex;align-items:center;gap:12px;margin-bottom:6px"><div style="width:110px;font-size:11px;color:var(--t2)">'+st+'</div><div style="flex:1;height:20px;background:var(--bg);border-radius:4px;overflow:hidden"><div style="width:'+pct+'%;height:100%;background:'+sc(st)+';border-radius:4px"></div></div><div style="width:40px;text-align:right;font-size:12px;font-weight:600;color:'+sc(st)+'">'+cnt+'</div></div>'});
h+='</div>';
h+='<div class="card"><h3>ü§ñ AI Daily Brief</h3><button class="ai-btn" id="ai-brief">Generate Today\'s Brief</button><div id="ai-brief-out" class="ai-out" style="display:'+(S.aiOutput?'block':'none')+'">'+eh(S.aiOutput)+'</div></div>';
return h}

function pgWeek(){
var cc=gc(),h='<h1>This Week</h1><div class="sub">Meetings, follow-ups, and outreach due</div>';
var mt=cc.filter(function(c){return c.meeting==='Yes'&&c.meetingDate});
h+='<div class="card"><h3>üìÖ Upcoming Meetings</h3>';
mt.forEach(function(c){h+='<div style="display:flex;align-items:center;gap:12px;padding:8px 0;border-bottom:1px solid var(--bd)"><div style="font-weight:600;cursor:pointer;color:var(--grn)" data-detail="'+c.id+'">'+eh(c.name)+'</div><div style="font-size:11px;color:var(--t3)">'+eh(c.title)+'</div><div style="margin-left:auto;font-size:11px;color:var(--t2)">'+eh(c.meetingDate)+'</div></div>'});
if(!mt.length)h+='<div style="color:var(--t3);padding:8px">No meetings scheduled</div>';
h+='</div>';
var fu=cc.filter(function(c){return c.outreachDate&&ds(c.outreachDate)>=3&&ds(c.outreachDate)<=14&&c.response!=='Yes'&&c.status!=='Engaged'&&c.status!=='Meeting Set'});
h+='<div class="card"><h3>‚Ü© Follow-ups Due</h3>';
fu.forEach(function(c){h+='<div style="display:flex;align-items:center;gap:12px;padding:8px 0;border-bottom:1px solid var(--bd)"><div style="font-weight:600;cursor:pointer" data-detail="'+c.id+'">'+eh(c.name)+'</div><div style="font-size:11px;color:var(--t3)">'+eh(c.title)+'</div><div style="margin-left:auto;font-size:11px;color:var(--gld)">'+ds(c.outreachDate)+' days since outreach</div></div>'});
if(!fu.length)h+='<div style="color:var(--t3);padding:8px">No follow-ups due</div>';
h+='</div>';
var nw=cc.filter(function(c){return c.status==='Not Started'||c.status==='Researching'}).sort(function(a,b){return(parseInt(a.seqDays)||999)-(parseInt(b.seqDays)||999)}).slice(0,8);
h+='<div class="card"><h3>üì§ New Outreach Queue</h3>';
nw.forEach(function(c){h+='<div style="display:flex;align-items:center;gap:12px;padding:8px 0;border-bottom:1px solid var(--bd)">'+bdg(c.tier,tc(c.tier))+'<div style="font-weight:600;cursor:pointer" data-detail="'+c.id+'">'+eh(c.name)+'</div><div style="font-size:11px;color:var(--t3)">'+eh(c.initiative)+'</div><div style="margin-left:auto;font-size:11px;color:var(--t2)">Day '+eh(c.seqDays)+'</div></div>'});
if(!nw.length)h+='<div style="color:var(--t3);padding:8px">All contacts reached</div>';
h+='</div>';return h}

function pgPipe(){
var cc=gc(),cols=['Not Started','Outreach Sent','Responded','Meeting Set','Engaged'];
var h='<h1>Pipeline</h1><div class="sub">Visual pipeline by status</div><div class="kanban">';
cols.forEach(function(col){
var cards=cc.filter(function(c){return col==='Not Started'?(c.status==='Not Started'||c.status==='Researching'):c.status===col});
h+='<div class="kcol"><div class="kcol-t"><span>'+col+'</span><span class="cnt">'+cards.length+'</span></div>';
cards.forEach(function(c){h+='<div class="kcard" data-detail="'+c.id+'"><div style="font-weight:600;font-size:12px;color:var(--t1)">'+eh(c.name)+'</div><div style="font-size:10px;color:var(--t3);margin-top:2px">'+eh(c.title)+'</div><div style="margin-top:6px">'+bdg(c.tier,tc(c.tier))+' '+bdg(c.initiative,ic(c.initiative))+'</div></div>'});
h+='</div>'});
h+='</div>';return h}

function pgContacts(){
var cc=gc(),filtered=cc.filter(function(c){
if(S.filterTier&&c.tier!==S.filterTier)return false;if(S.filterStatus&&c.status!==S.filterStatus)return false;
if(S.filterInit&&c.initiative.indexOf(S.filterInit)<0)return false;
if(S.filterText&&(c.name+' '+c.title+' '+c.location).toLowerCase().indexOf(S.filterText.toLowerCase())<0)return false;return true});
var h='<h1>Contacts</h1><div class="sub">'+filtered.length+' of '+cc.length+' contacts</div>';
h+='<div class="filters"><input placeholder="Search names..." value="'+eh(S.filterText)+'" id="f-text">';
h+='<select id="f-tier"><option value="">All Tiers</option><option value="Tier 0"'+(S.filterTier==='Tier 0'?' selected':'')+'>Tier 0</option><option value="Tier 1"'+(S.filterTier==='Tier 1'?' selected':'')+'>Tier 1</option><option value="Tier 2"'+(S.filterTier==='Tier 2'?' selected':'')+'>Tier 2</option></select>';
h+='<select id="f-status"><option value="">All Statuses</option>';
['Not Started','Researching','Outreach Sent','Responded','Meeting Set','Engaged','Stalled','Nurture','Closed Won'].forEach(function(s){h+='<option value="'+s+'"'+(S.filterStatus===s?' selected':'')+'>'+s+'</option>'});
h+='</select><select id="f-init"><option value="">All Initiatives</option>';
['Advisory','AI','Motivair','Digital','EcoStruxure'].forEach(function(i){h+='<option value="'+i+'"'+(S.filterInit===i?' selected':'')+'>'+i+'</option>'});
h+='</select></div>';
h+='<div style="overflow-x:auto"><table><thead><tr><th>Name</th><th>Title</th><th>Tier</th><th>Initiative</th><th>Status</th><th>Timing</th><th>Role</th><th>Fit</th></tr></thead><tbody>';
filtered.forEach(function(c){h+='<tr class="clk" data-detail="'+c.id+'"><td style="font-weight:600;color:var(--t1)">'+eh(c.name)+'</td><td>'+eh(c.title)+'</td><td>'+bdg(c.tier,tc(c.tier))+'</td><td>'+bdg(c.initiative,ic(c.initiative))+'</td><td>'+bdg(c.status,sc(c.status))+'</td><td style="color:'+(c.timing==='Immediate'?'var(--red)':'var(--t2)')+'">'+eh(c.timing)+'</td><td>'+eh(c.buyingRole)+'</td><td style="color:var(--grn);font-weight:700">'+eh(c.fit)+'</td></tr>'});
h+='</tbody></table></div>';return h}

function pgOrg(){
var cc=gc(),layers=[
{title:'C-Suite / CEO',fn:function(c){return c.title.indexOf('CEO')>=0||c.title.indexOf('President')>=0}},
{title:'ExCom / EVP / SVP',fn:function(c){return c.title.indexOf('EVP')>=0||c.title.indexOf('SVP')>=0||(c.title.indexOf('Chief')>=0&&c.title.indexOf('CEO')<0)}},
{title:'VP / Director',fn:function(c){return c.title.indexOf('VP')>=0&&c.title.indexOf('SVP')<0&&c.title.indexOf('EVP')<0}},
{title:'Execution / Manager',fn:function(c){return c.title.indexOf('VP')<0&&c.title.indexOf('Chief')<0&&c.title.indexOf('CEO')<0&&c.title.indexOf('President')<0}}
];
var h='<h1>Org Chart</h1><div class="sub">Schneider Electric hierarchy ‚Äî click any contact for details</div>';
layers.forEach(function(layer){var people=cc.filter(layer.fn);if(!people.length)return;
h+='<div class="org-layer"><div class="org-lt">'+layer.title+' ('+people.length+')</div><div class="org-cards">';
people.forEach(function(c){h+='<div class="oc" style="border-left:3px solid '+ic(c.initiative)+'" data-detail="'+c.id+'"><div style="font-weight:600;font-size:12px">'+eh(c.name)+'</div><div style="font-size:10px;color:var(--t3);margin-top:2px">'+eh(c.title)+'</div><div style="margin-top:6px">'+bdg(c.initiative,ic(c.initiative))+'</div></div>'});
h+='</div></div>'});return h}

function pgStrat(){
var h='<h1>Strategy Map</h1><div class="sub">5 strategic plays with coverage analysis</div>';
PLAYS.forEach(function(p){
var expanded=S.expandedPlays[p.id];
var pcc=gc().filter(function(c){var k=p.id==='advisory'?'advisory':p.id==='ai'?'ai':p.id==='cooling'?'motivair':p.id==='digital'?'digital':'';return k&&c.initiative.toLowerCase().indexOf(k)>=0});
var cov=pcc.length?Math.min(100,Math.round(pcc.filter(function(c){return c.status!=='Not Started'}).length/pcc.length*100)):0;
h+='<div class="play-card'+(expanded?' exp':'')+'" data-play="'+p.id+'">';
h+='<div class="play-h"><div><h3 style="color:'+p.color+'">'+eh(p.name)+'</h3><div style="font-size:11px;color:var(--t3);margin-top:2px">'+eh(p.desc)+'</div></div><div style="display:flex;align-items:center;gap:12px"><span style="font-size:12px;font-weight:600;color:'+p.color+'">'+pcc.length+' contacts</span><span class="pa">‚ñº</span></div></div>';
h+='<div class="play-b"><div style="margin-bottom:12px"><div style="font-size:10px;color:var(--t3);margin-bottom:4px">OUTREACH COVERAGE</div><div class="cov-bar"><div class="fill" style="width:'+cov+'%;background:'+p.color+'"></div></div><div style="font-size:11px;color:var(--t2);margin-top:4px">'+cov+'% reached</div></div>';
if(p.sponsors.length){h+='<div style="margin-bottom:8px"><div style="font-size:10px;color:var(--t3);margin-bottom:4px">EXCOM SPONSORS</div>';p.sponsors.forEach(function(n){h+='<span class="badge" style="background:var(--gld2);color:var(--gld);margin:0 4px 4px 0">'+eh(n)+'</span>'});h+='</div>'}
if(p.vps.length){h+='<div style="margin-bottom:8px"><div style="font-size:10px;color:var(--t3);margin-bottom:4px">VP OWNERS</div>';p.vps.forEach(function(n){h+='<span class="badge" style="background:var(--blu2);color:var(--blu);margin:0 4px 4px 0">'+eh(n)+'</span>'});h+='</div>'}
if(p.exec.length){h+='<div><div style="font-size:10px;color:var(--t3);margin-bottom:4px">EXECUTION</div>';p.exec.forEach(function(n){h+='<span class="badge" style="background:var(--grn3);color:var(--grn);margin:0 4px 4px 0">'+eh(n)+'</span>'});h+='</div>'}
h+='</div></div>'});return h}

function pgWin(){
var h='<h1>Win Themes</h1><div class="sub">Positioning by play, adapted for buyer types</div>';
WIN_THEMES.forEach(function(w){h+='<div class="wt-c"><h3>'+eh(w.play)+': '+eh(w.theme)+'</h3><div class="wt-b"><strong>Technical Buyer</strong>'+eh(w.technical)+'</div><div class="wt-b"><strong>Economic Buyer</strong>'+eh(w.economic)+'</div></div>'});
return h}

function pgComp(){
var h='<h1>Competitive Intel</h1><div class="sub">Where they\'re embedded and how to displace</div>';
COMPETITORS.forEach(function(c){h+='<div class="comp-c"><h3>'+eh(c.name)+'</h3><div style="font-size:12px;color:var(--t2);margin-bottom:8px"><strong style="color:var(--t3);font-size:10px">WHERE THEY\'RE EMBEDDED</strong><br>'+eh(c.where)+'</div><div style="font-size:12px;color:var(--grn);padding:8px 12px;background:var(--grn3);border-radius:var(--radius);margin-top:8px"><strong style="color:var(--grn);font-size:10px;display:block;margin-bottom:4px">DISPLACEMENT STRATEGY</strong>'+eh(c.displace)+'</div></div>'});
return h}

function pgMeet(){
var cc=gc(),h='<h1>Meeting Prep</h1><div class="sub">AI-generated meeting briefs</div><div class="ai-p">';
h+='<label style="display:block;font-size:11px;color:var(--t3);margin-bottom:6px">Select a contact</label>';
h+='<select id="mp-c" style="width:100%;padding:10px 12px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);color:var(--t1)"><option value="">Choose contact...</option>';
cc.forEach(function(c){h+='<option value="'+c.id+'">'+eh(c.name)+' ‚Äî '+eh(c.title)+'</option>'});
h+='</select><button class="ai-btn" id="mp-gen">‚úé Generate Meeting Brief</button><div id="mp-out" class="ai-out" style="display:none"></div></div>';
return h}

function pgSeq(){
var cc=gc(),h='<h1>Outreach Sequencer</h1><div class="sub">AI-generated 3-touch outreach sequences</div><div class="ai-p">';
h+='<label style="display:block;font-size:11px;color:var(--t3);margin-bottom:6px">Select a contact</label>';
h+='<select id="seq-c" style="width:100%;padding:10px 12px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);color:var(--t1)"><option value="">Choose contact...</option>';
cc.forEach(function(c){h+='<option value="'+c.id+'">'+eh(c.name)+' ‚Äî '+eh(c.title)+'</option>'});
h+='</select><button class="ai-btn" id="seq-gen">‚Üª Generate 3-Touch Sequence</button><div id="seq-out" class="ai-out" style="display:none"></div></div>';
return h}

function pgExec(){
var h='<h1>Executive Brief</h1><div class="sub">AI-generated leadership report</div><div class="ai-p">';
h+='<p style="color:var(--t2);margin-bottom:12px">Generate a comprehensive executive summary of your Schneider Electric engagement.</p>';
h+='<button class="ai-btn" id="eb-gen">‚ä° Generate Exec Brief</button><div id="eb-out" class="ai-out" style="display:none"></div></div>';
return h}

function pgAI(){
var h='<h1>AI Intelligence</h1><div class="sub">Ask anything about the Schneider account</div><div class="ai-p">';
h+='<textarea id="ai-q" placeholder="e.g., What\'s my strongest path to a meeting with Philippe Rambach?"></textarea>';
h+='<button class="ai-btn" id="ai-go">‚ö° Ask AI</button><div id="ai-out" class="ai-out" style="display:none"></div></div>';
return h}

function pgRel(){
var h='<h1>Relationships</h1><div class="sub">Connection map between contacts</div><div class="rel-grid">';
RELS.forEach(function(r){h+='<div class="rel-c"><div style="font-weight:600;color:var(--t1)">'+eh(r.from)+'</div><div style="font-size:10px;color:var(--grn);margin:4px 0">'+eh(r.type)+'</div><div style="color:var(--t2)">'+eh(r.to)+'</div></div>'});
h+='</div>';return h}

function pgRisks(){
var cc=gc(),h='<h1>Risk Monitor</h1><div class="sub">Stalled outreach, missing next steps, single-threaded plays</div>';
var stalled=cc.filter(function(c){return c.outreachDate&&ds(c.outreachDate)>14&&c.response!=='Yes'&&c.status!=='Engaged'&&c.status!=='Meeting Set'});
h+='<div class="card"><h3>üî¥ Stalled Outreach (14+ days)</h3>';
stalled.forEach(function(c){h+='<div class="risk-item"><div class="rdot hi"></div><div style="flex:1"><div style="font-weight:600;cursor:pointer" data-detail="'+c.id+'">'+eh(c.name)+'</div><div style="font-size:11px;color:var(--t3)">'+ds(c.outreachDate)+' days since outreach via '+eh(c.channel)+'</div></div></div>'});
if(!stalled.length)h+='<div style="color:var(--t3);padding:8px">No stalled contacts</div>';h+='</div>';
var noNext=cc.filter(function(c){return!c.nextStep&&c.status!=='Not Started'&&c.status!=='Closed Won'});
h+='<div class="card"><h3>üü° Missing Next Step</h3>';
noNext.forEach(function(c){h+='<div class="risk-item"><div class="rdot md"></div><div style="flex:1"><div style="font-weight:600;cursor:pointer" data-detail="'+c.id+'">'+eh(c.name)+'</div><div style="font-size:11px;color:var(--t3)">'+eh(c.status)+' ‚Äî no next step</div></div></div>'});
if(!noNext.length)h+='<div style="color:var(--t3);padding:8px">All active contacts have next steps</div>';h+='</div>';
h+='<div class="card"><h3>üü† Single-Threaded Plays</h3>';
PLAYS.forEach(function(p){var k=p.id==='advisory'?'advisory':p.id==='ai'?'ai':p.id==='cooling'?'motivair':p.id==='digital'?'digital':'';
var eng=gc().filter(function(c){return k&&c.initiative.toLowerCase().indexOf(k)>=0&&c.status!=='Not Started'});
if(eng.length<=1)h+='<div class="risk-item"><div class="rdot '+(eng.length===0?'hi':'md')+'"></div><div style="flex:1"><div style="font-weight:600;color:'+p.color+'">'+eh(p.name)+'</div><div style="font-size:11px;color:var(--t3)">'+(eng.length===0?'No active contacts':'Only 1 active contact ‚Äî needs multi-threading')+'</div></div></div>'});
h+='</div>';return h}

function pgSettings(){
var h='<h1>Settings</h1><div class="sub">Configure API keys and connections</div><div class="card">';
h+='<div class="dp-f"><label>Google Sheets API Key</label><input id="s-gapi" type="password" value="'+eh(S.gApiKey)+'" style="width:100%;padding:10px 12px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);color:var(--t1)"></div>';
h+='<div class="dp-f"><label>Sheet ID</label><input id="s-sheet" value="'+eh(S.sheetId)+'" style="width:100%;padding:10px 12px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);color:var(--t1)"></div>';
h+='<div class="dp-f"><label>Anthropic API Key</label><input id="s-claude" type="password" value="'+eh(S.claudeKey)+'" style="width:100%;padding:10px 12px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);color:var(--t1)"></div>';
h+='<div class="dp-f"><label>Apps Script Web App URL</label><input id="s-webapp" value="'+eh(S.webAppUrl)+'" style="width:100%;padding:10px 12px;background:var(--bg);border:1px solid var(--bd);border-radius:var(--radius);color:var(--t1)"></div>';
h+='<button class="ai-btn" id="s-save">Save Settings</button>';
h+='<div style="margin-top:16px;padding:12px;background:var(--bg);border-radius:var(--radius);font-size:11px;color:var(--t3)">';
h+='<strong style="color:var(--t2)">Status:</strong> '+(S.conn?'<span style="color:var(--grn)">‚óè Connected to Google Sheet</span>':'<span>‚óè Demo Mode (no API key)</span>');
h+='<br><strong style="color:var(--t2)">Contacts:</strong> '+gc().length;
h+='<br><strong style="color:var(--t2)">Last sync:</strong> '+(S.lastSync?S.lastSync.toLocaleString():'Never');
h+='</div></div>';return h}
// ===== RENDER ENGINE =====
function render(){
var app=document.getElementById('app');
if(S.screen==='login'){app.innerHTML=renderLogin();bindLogin()}
else{app.innerHTML=renderShell();bindShell()}
}

function renderLogin(){
return'<div class="login-wrap"><div class="login-box">'+
'<div class="login-logo"><svg width="36" height="36" viewBox="0 0 100 100"><rect width="100" height="100" rx="16" fill="#3DCC4A"/><path d="M25 70L25 45L50 30L75 45L75 55L50 40L35 48L35 60L50 68L65 60L65 52L50 44L40 50L40 58L50 63L55 60" stroke="#fff" stroke-width="4" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg><div><div class="lt">Command Center</div><div class="ls">Schneider Electric</div></div></div>'+
'<label>Google Sheets API Key</label><input id="lg-gapi" type="password" placeholder="AIza..." value="'+eh(S.gApiKey)+'">'+
'<label>Anthropic API Key <span style="color:var(--t3)">(optional ‚Äî for AI features)</span></label><input id="lg-claude" type="password" placeholder="sk-ant-..." value="'+eh(S.claudeKey)+'">'+
'<label>Sheet ID</label><input id="lg-sheet" value="'+eh(S.sheetId)+'">'+
'<button class="btn-login" id="lg-go">Launch Command Center</button>'+
'<button class="btn-demo" id="lg-demo">Enter Demo Mode (12 contacts loaded)</button>'+
'</div></div>'}

function bindLogin(){
var go=document.getElementById('lg-go'),demo=document.getElementById('lg-demo');
if(go)go.onclick=function(){
S.gApiKey=document.getElementById('lg-gapi').value.trim();
S.claudeKey=document.getElementById('lg-claude').value.trim();
S.sheetId=document.getElementById('lg-sheet').value.trim();
localStorage.setItem('cc_gApiKey',S.gApiKey);localStorage.setItem('cc_claudeKey',S.claudeKey);localStorage.setItem('cc_sheetId',S.sheetId);
S.screen='app';render();fetchSheet(function(rows){if(rows.length)S.contacts=rows;render()})};
if(demo)demo.onclick=function(){S.screen='app';S.contacts=[];render()}}

function renderShell(){
return'<div class="shell">'+renderSB()+'<div style="flex:1;display:flex;flex-direction:column">'+renderGS()+'<div class="main" style="margin-top:48px">'+renderPage()+'</div></div>'+renderDP()+'</div>'+renderGSR()}

function renderSB(){
var h='<div class="sidebar"><div class="sb-logo"><svg width="28" height="28" viewBox="0 0 100 100"><rect width="100" height="100" rx="16" fill="#3DCC4A"/><path d="M25 70L25 45L50 30L75 45L75 55L50 40L35 48L35 60L50 68L65 60L65 52L50 44L40 50L40 58L50 63L55 60" stroke="#fff" stroke-width="4" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg><div><div class="lt">Command Center</div><div class="ls">Schneider Electric</div></div></div>';
NAV.forEach(function(sec){h+='<div class="nav-sec"><div class="nav-sec-title">'+sec.s+'</div>';
sec.items.forEach(function(it){h+='<button class="nav-btn'+(S.tab===it.id?' on':'')+'" data-tab="'+it.id+'"><span class="ni">'+it.icon+'</span><span>'+it.l+'</span></button>'});h+='</div>'});
h+='<a class="sb-oe" href="https://outreach-engine-dun.vercel.app" target="_blank">‚ö° <span>Outreach Engine</span></a>';
h+='<div class="sb-footer">'+(S.conn?'<span style="color:var(--grn)">‚óè Sheet Connected</span>':'<span>‚óè Demo Mode</span>');
h+='<button class="sync-btn" id="syncbtn">'+(S.syncing?'<span class="spinner"></span>':'‚Üª Sync')+'</button>';
if(S.lastSync)h+='<div style="margin-top:4px">Last: '+S.lastSync.toLocaleTimeString()+'</div>';
h+='</div></div>';return h}

function renderGS(){
return'<div class="gs-bar"><span class="gsi">‚åï</span><input id="gs-input" placeholder="Search contacts, plays, pages..." value="'+eh(S.search)+'"><span class="gsh">/</span></div>'}

function renderGSR(){
if(!S.searchOpen||!S.searchResults.length)return'';
var h='<div class="gs-res active">',lt='';
S.searchResults.forEach(function(r,i){
if(r.type!==lt){var labels={contact:'Contacts',play:'Strategic Plays',page:'Pages',competitor:'Competitors'};h+='<div class="gs-cat">'+(labels[r.type]||r.type)+'</div>';lt=r.type}
h+='<div class="gs-item'+(i===S.searchIdx?' sel':'')+'" data-gsi="'+i+'"><span class="gn">'+eh(r.name)+'</span><span class="gm">'+eh(r.meta)+'</span></div>'});
h+='</div>';return h}

function renderDP(){
if(!S.detailId)return'<div class="dp"></div>';
var c=gc().find(function(x){return x.id===S.detailId});
if(!c)return'<div class="dp"></div>';
var h='<div class="dp open"><button class="dp-x" id="dp-close">‚úï</button>';
h+='<h2 style="font-size:18px;font-weight:700;margin-bottom:4px">'+eh(c.name)+'</h2><div style="font-size:12px;color:var(--t2);margin-bottom:16px">'+eh(c.title)+'</div>';
h+='<div style="display:flex;gap:6px;margin-bottom:16px;flex-wrap:wrap">'+bdg(c.tier,tc(c.tier))+bdg(c.status,sc(c.status))+bdg(c.initiative,ic(c.initiative))+'</div>';
if(c.linkedin)h+='<div class="dp-f"><label>LinkedIn</label><div class="dv"><a href="'+eh(c.linkedin)+'" target="_blank">'+eh(c.name)+' ‚Üí</a></div></div>';
h+='<div class="dp-f"><label>Location</label><div class="dv">'+eh(c.location)+'</div></div>';
h+='<div class="dp-f"><label>Buying Role</label><div class="dv">'+eh(c.buyingRole)+'</div></div>';
h+='<div class="dp-f"><label>Toptal Fit Score</label><div class="dv" style="color:var(--grn);font-size:18px;font-weight:700">'+eh(c.fit)+'/10</div></div>';
h+='<div class="dp-f"><label>Why They Buy Now</label><div class="dv">'+eh(c.whyBuyNow)+'</div></div>';
h+='<div class="dp-f"><label>Outreach Hook</label><div class="dv" style="color:var(--grn)">'+eh(c.hook)+'</div></div>';
h+='<div class="dp-f"><label>Budget Signal</label><div class="dv">'+eh(c.budgetSignal)+'</div></div>';
h+='<div class="dp-f"><label>Next Step</label><div class="dv">'+eh(c.nextStep)+'</div></div>';
h+='<div class="dp-f"><label>Notes</label><div class="dv">'+eh(c.notes)+'</div></div>';
h+='<div class="dp-f"><label>Sequence</label><div class="dv">Day '+eh(c.seqDays)+' ¬∑ '+eh(c.seqPhase)+'</div></div>';
h+='<button class="ai-btn" id="dp-meetprep" style="width:100%;justify-content:center;margin-top:8px">‚úé Generate Meeting Brief</button>';
h+='</div>';return h}

function renderPage(){
var fn={dashboard:pgDash,thisweek:pgWeek,pipeline:pgPipe,contacts:pgContacts,orgchart:pgOrg,stratmap:pgStrat,winthemes:pgWin,competitive:pgComp,meetprep:pgMeet,sequencer:pgSeq,execbrief:pgExec,aiintel:pgAI,relations:pgRel,risks:pgRisks,settings:pgSettings};
return(fn[S.tab]||pgDash)()}

// ===== EVENT BINDINGS =====
function bindShell(){
// Nav buttons
document.querySelectorAll('[data-tab]').forEach(function(btn){btn.onclick=function(){S.tab=this.getAttribute('data-tab');S.detailId=null;render()}});
// Sync
var syncBtn=document.getElementById('syncbtn');
if(syncBtn)syncBtn.onclick=function(){fetchSheet(function(rows){if(rows.length)S.contacts=rows;render()})};
// Detail triggers
document.querySelectorAll('[data-detail]').forEach(function(el){el.onclick=function(e){e.stopPropagation();S.detailId=parseInt(this.getAttribute('data-detail'));render()}});
// Close detail
var dpClose=document.getElementById('dp-close');
if(dpClose)dpClose.onclick=function(){S.detailId=null;render()};
// Play toggles
document.querySelectorAll('[data-play]').forEach(function(el){
el.querySelector('.play-h').onclick=function(){var pid=el.getAttribute('data-play');S.expandedPlays[pid]=!S.expandedPlays[pid];render()}});
// Search input
var gsInput=document.getElementById('gs-input');
if(gsInput){
gsInput.oninput=function(){S.search=this.value;doSearch(S.search);S.searchOpen=S.search.length>0;render();
var inp=document.getElementById('gs-input');if(inp){inp.focus();inp.setSelectionRange(S.search.length,S.search.length)}};
gsInput.onfocus=function(){if(S.search)S.searchOpen=true;render();var inp=document.getElementById('gs-input');if(inp)inp.focus()};
}
// Search result clicks
document.querySelectorAll('[data-gsi]').forEach(function(el){el.onclick=function(){var idx=parseInt(this.getAttribute('data-gsi'));if(S.searchResults[idx])S.searchResults[idx].action()}});
// Filters
var ft=document.getElementById('f-text');if(ft)ft.oninput=function(){S.filterText=this.value;render();var el=document.getElementById('f-text');if(el){el.focus();el.setSelectionRange(S.filterText.length,S.filterText.length)}};
var fTier=document.getElementById('f-tier');if(fTier)fTier.onchange=function(){S.filterTier=this.value;render()};
var fStat=document.getElementById('f-status');if(fStat)fStat.onchange=function(){S.filterStatus=this.value;render()};
var fInit=document.getElementById('f-init');if(fInit)fInit.onchange=function(){S.filterInit=this.value;render()};
// Settings save
var sSave=document.getElementById('s-save');
if(sSave)sSave.onclick=function(){
S.gApiKey=document.getElementById('s-gapi').value.trim();
S.sheetId=document.getElementById('s-sheet').value.trim();
S.claudeKey=document.getElementById('s-claude').value.trim();
S.webAppUrl=document.getElementById('s-webapp').value.trim();
localStorage.setItem('cc_gApiKey',S.gApiKey);localStorage.setItem('cc_sheetId',S.sheetId);
localStorage.setItem('cc_claudeKey',S.claudeKey);localStorage.setItem('cc_webAppUrl',S.webAppUrl);
alert('Settings saved!');render()};

// ===== AI BUTTONS =====
function contactSummary(){var cc=gc();return cc.map(function(c){return c.name+' ('+c.title+', '+c.tier+', '+c.status+', '+c.initiative+')'}).join('; ')}

var aiBrief=document.getElementById('ai-brief');
if(aiBrief)aiBrief.onclick=function(){
var cc=gc(),total=cc.length,engaged=cc.filter(function(c){return c.status==='Engaged'}).length;
aiCall('You are a sales intelligence analyst for Toptal. Generate a concise daily brief for the Schneider Electric account. Here are the current contacts: '+contactSummary()+'. Include: 1) Top 3 priorities for today 2) Key risks 3) Recommended actions. Be specific with names and concrete next steps.',function(text){
S.aiOutput=text;var el=document.getElementById('ai-brief-out');if(el){el.style.display='block';el.textContent=text}})};

var mpGen=document.getElementById('mp-gen');
if(mpGen)mpGen.onclick=function(){
var sel=document.getElementById('mp-c');if(!sel||!sel.value)return;
var c=gc().find(function(x){return x.id===parseInt(sel.value)});if(!c)return;
aiCall('Generate a meeting brief for a sales meeting with '+c.name+', '+c.title+' at Schneider Electric. Context: Initiative='+c.initiative+', Why They Buy Now='+c.whyBuyNow+', Outreach Hook='+c.hook+', Budget Signal='+c.budgetSignal+', Buying Role='+c.buyingRole+'. Include: 1) Executive Summary 2) Talk Track 3) Discovery Questions 4) Objection Handling 5) Desired Outcomes. Frame everything around Toptal as a workforce transformation partner.',function(text){
var el=document.getElementById('mp-out');if(el){el.style.display='block';el.textContent=text}})};

var seqGen=document.getElementById('seq-gen');
if(seqGen)seqGen.onclick=function(){
var sel=document.getElementById('seq-c');if(!sel||!sel.value)return;
var c=gc().find(function(x){return x.id===parseInt(sel.value)});if(!c)return;
aiCall('Generate a 3-touch outreach sequence for '+c.name+', '+c.title+' at Schneider Electric. Context: Initiative='+c.initiative+', Why They Buy Now='+c.whyBuyNow+', Hook='+c.hook+', LinkedIn='+c.linkedin+'. Generate: Touch 1 (LinkedIn connection request, max 300 chars), Touch 2 (InMail or email, max 1900 chars), Touch 3 (Follow-up, max 500 chars). Make it personal, reference real Schneider initiatives, and position Toptal as a strategic workforce partner.',function(text){
var el=document.getElementById('seq-out');if(el){el.style.display='block';el.textContent=text}})};

var ebGen=document.getElementById('eb-gen');
if(ebGen)ebGen.onclick=function(){
aiCall('Generate an executive brief for Toptal leadership about the Schneider Electric account. Contacts: '+contactSummary()+'. Include: 1) Account Overview 2) Pipeline Status 3) Key Relationships 4) Strategic Opportunities 5) Risks & Mitigations 6) 30/60/90 Day Recommendations. Be specific and data-driven.',function(text){
var el=document.getElementById('eb-out');if(el){el.style.display='block';el.textContent=text}})};

var aiGo=document.getElementById('ai-go');
if(aiGo)aiGo.onclick=function(){
var q=document.getElementById('ai-q');if(!q||!q.value.trim())return;
aiCall('You are a sales intelligence analyst for Toptal working on the Schneider Electric account. Here are the current contacts and their details: '+contactSummary()+'. Strategic plays: SE Advisory, AI/ML, Motivair/Cooling, Digital/EcoStruxure, Executive Engagement. Answer this question: '+q.value,function(text){
var el=document.getElementById('ai-out');if(el){el.style.display='block';el.textContent=text}})};

// Detail panel meeting prep
var dpMeet=document.getElementById('dp-meetprep');
if(dpMeet)dpMeet.onclick=function(){
var c=gc().find(function(x){return x.id===S.detailId});if(!c)return;
S.tab='meetprep';render();
setTimeout(function(){var sel=document.getElementById('mp-c');if(sel)sel.value=c.id},50)};
}

// ===== KEYBOARD SHORTCUTS =====
document.addEventListener('keydown',function(e){
if(S.screen!=='app')return;
// / to focus search
if(e.key==='/'&&document.activeElement.tagName!=='INPUT'&&document.activeElement.tagName!=='TEXTAREA'){e.preventDefault();var inp=document.getElementById('gs-input');if(inp)inp.focus();return}
// Escape to close search or detail
if(e.key==='Escape'){if(S.searchOpen){S.searchOpen=false;S.search='';render();return}if(S.detailId){S.detailId=null;render();return}}
// Arrow keys in search
if(S.searchOpen&&S.searchResults.length){
if(e.key==='ArrowDown'){e.preventDefault();S.searchIdx=Math.min(S.searchIdx+1,S.searchResults.length-1);render();var inp=document.getElementById('gs-input');if(inp)inp.focus();return}
if(e.key==='ArrowUp'){e.preventDefault();S.searchIdx=Math.max(S.searchIdx-1,0);render();var inp=document.getElementById('gs-input');if(inp)inp.focus();return}
if(e.key==='Enter'){e.preventDefault();if(S.searchResults[S.searchIdx])S.searchResults[S.searchIdx].action();return}}
});

// Close search on click outside
document.addEventListener('click',function(e){
if(S.searchOpen&&!e.target.closest('.gs-bar')&&!e.target.closest('.gs-res')){S.searchOpen=false;render()}
});

// ===== INIT =====
render();
// Auto-fetch from Google Sheet on load
if(S.gApiKey&&S.sheetId){fetchSheet(function(rows){if(rows.length)S.contacts=rows;render()})}

</script>
</body>
</html>
